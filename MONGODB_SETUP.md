# MongoDB Atlas Setup Guide

## Step-by-Step Guide to Create Free MongoDB Cluster

### Step 1: Create MongoDB Atlas Account

1. **Go to MongoDB Atlas:**
   - Visit: [https://www.mongodb.com/cloud/atlas/register](https://www.mongodb.com/cloud/atlas/register)

2. **Sign Up:**
   - Use Google/GitHub account (fastest)
   - OR create account with email/password
   - Complete registration

3. **Login:**
   - Go to [https://cloud.mongodb.com](https://cloud.mongodb.com)

---

### Step 2: Create a Free Cluster

1. **Create New Project (if first time):**
   - Click "New Project"
   - Name: `IndiaBorn` (or any name)
   - Click "Next" → "Create Project"

2. **Build a Database:**
   - Click "Build a Database" button
   - OR click "+ Create" in Database Deployments

3. **Choose Free Tier:**
   - Select **M0 (FREE)** - Shared cluster
   - Features: 512 MB storage, Shared RAM, Free forever

4. **Select Cloud Provider & Region:**
   - Provider: **AWS**, **Google Cloud**, or **Azure**
   - Region: Choose closest to your users
     - For India: Mumbai, Singapore, or Bangalore
   - Name: Leave default or change (e.g., `IndiaBorn-Cluster`)

5. **Click "Create":**
   - Wait 1-3 minutes for cluster to deploy

---

### Step 3: Create Database User

1. **Security Quickstart appears automatically**
   - OR go to: Database Access (left sidebar)

2. **Add New Database User:**
   - Click "Add New Database User"
   - Authentication Method: **Password**
   - Username: `indiaborn_admin` (or any name)
   - Password: Click "Autogenerate Secure Password" 
     - **COPY AND SAVE THIS PASSWORD!** You'll need it later
   - Database User Privileges: **Read and write to any database**
   - Click "Add User"

---

### Step 4: Whitelist IP Addresses

1. **Network Access (left sidebar):**
   - Click "Network Access"

2. **Add IP Address:**
   - Click "Add IP Address"

3. **Allow Access From Anywhere (for development):**
   - Click "Allow Access from Anywhere"
   - This adds `0.0.0.0/0` (all IPs)
   - Click "Confirm"

   **Note:** For production, add specific Render IPs or your server IPs

4. **Wait for Status:**
   - Status changes from "Pending" to "Active" (~1 minute)

---

### Step 5: Get Connection String

1. **Go to Database:**
   - Click "Database" in left sidebar
   - You'll see your cluster

2. **Click "Connect":**
   - Click "Connect" button on your cluster

3. **Choose Connection Method:**
   - Select "Drivers"
   - Driver: **C# / .NET**
   - Version: Select latest

4. **Copy Connection String:**
   - You'll see something like:
     ```
     mongodb+srv://indiaborn_admin:<password>@cluster0.xxxxx.mongodb.net/?retryWrites=true&w=majority
     ```

5. **Replace `<password>`:**
   - Replace `<password>` with the actual password you saved earlier
   - Example final string:
     ```
     mongodb+srv://indiaborn_admin:MySecurePass123@cluster0.abc12.mongodb.net/?retryWrites=true&w=majority
     ```

---

### Step 6: Test Connection (Optional)

1. **Using MongoDB Compass (GUI tool):**
   - Download: [https://www.mongodb.com/products/compass](https://www.mongodb.com/products/compass)
   - Open Compass
   - Paste connection string
   - Click "Connect"

2. **Using your .NET application:**
   - Update `appsettings.json`:
     ```json
     "Mongo": {
       "ConnectionString": "mongodb+srv://indiaborn_admin:YourPassword@cluster0.xxxxx.mongodb.net/?retryWrites=true&w=majority",
       "DatabaseName": "IndiabornDb"
     }
     ```
   - Run your backend locally
   - Check if it connects

---

### Step 7: Create Database & Collections (Optional)

MongoDB automatically creates database and collections when you insert data, but you can create them manually:

1. **In Atlas Dashboard:**
   - Click "Browse Collections"
   - Click "Add My Own Data"
   - Database Name: `IndiabornDb`
   - Collection Name: `products`
   - Click "Create"

2. **Repeat for other collections:**
   - `orders`
   - `users`

---

## For Render Deployment

### Environment Variable Format:

When adding to Render, use this format:

```
MongoSettings__ConnectionString=mongodb+srv://username:password@cluster0.xxxxx.mongodb.net/?retryWrites=true&w=majority
MongoSettings__DatabaseName=IndiabornDb
```

**Important Notes:**
- Replace `username` with your actual username
- Replace `password` with your actual password
- Replace `cluster0.xxxxx` with your actual cluster address
- Use double underscore `__` for nested configuration in .NET

---

## Security Best Practices

### For Production:

1. **Strong Password:**
   - Use autogenerated password (complex, 20+ characters)
   - Store securely (password manager or environment variables)

2. **Network Access:**
   - Instead of `0.0.0.0/0`, add specific IPs:
   - Get Render outbound IPs from Render docs
   - Add only those IPs to Atlas whitelist

3. **Database User:**
   - Create separate user for production
   - Use minimal required privileges
   - Don't use admin user in production

4. **Connection String:**
   - Never commit to Git
   - Store in environment variables only
   - Use different credentials for dev/prod

---

## Common Issues & Solutions

### Issue 1: "Authentication Failed"
**Solution:** Password incorrect, replace `<password>` in connection string

### Issue 2: "Connection Timeout"
**Solution:** 
- Check network access whitelist
- Add `0.0.0.0/0` or your IP
- Wait for status to be "Active"

### Issue 3: "Database Not Found"
**Solution:** MongoDB creates database automatically on first write, just continue

### Issue 4: "Too Many Connections" (Free tier)
**Solution:** 
- Free tier has limited connections
- Close unused connections
- Use connection pooling in your app

---

## Free Tier Limits

**M0 (Free Forever) includes:**
- ✅ 512 MB storage
- ✅ Shared RAM
- ✅ Shared vCPU
- ✅ No credit card required
- ❌ No backups
- ❌ Limited to 100 connections
- ❌ Cannot scale vertically

**Upgrade Options:**
- M10: $0.08/hour (~$57/month) - Dedicated, 2GB RAM
- Backups, scaling, more connections

---

## Quick Reference

### Your MongoDB Details (Fill this in):

```
Cluster Name: _______________________
Username: ___________________________
Password: ___________________________ (Keep secret!)
Connection String: __________________
Database Name: IndiabornDb
```

### Collections Needed:
- `products` - Product catalog
- `orders` - Customer orders
- `users` - User accounts

---

## Support & Resources

- [MongoDB Atlas Documentation](https://www.mongodb.com/docs/atlas/)
- [Connection String Guide](https://www.mongodb.com/docs/manual/reference/connection-string/)
- [Free Tier Info](https://www.mongodb.com/pricing)
- [MongoDB University](https://university.mongodb.com/) - Free courses

---

## Next Steps After Creating Cluster

1. ✅ Copy connection string
2. ✅ Save username & password securely
3. ✅ Update local `appsettings.json` for testing
4. ✅ Test connection locally
5. ✅ Add to Render environment variables
6. ✅ Deploy your application
7. ✅ Verify data is being stored

---

## Video Tutorial (If Needed)

Search YouTube for: "MongoDB Atlas Free Cluster Setup 2024"
- Official MongoDB channel has great tutorials
- Usually 5-10 minute videos
- Shows every step visually

---

**Ready to deploy?** Once you have your connection string, add it to Render environment variables and deploy!
